# Example Workflow - "Watermark Image"
# 
# This is a fairly simple workflow (despite appearances).
# Given three arguments (text, image, color), it will 
# output the base64-encoded contents of provided image 
# watermarked with the provided text in the specified color.
#
# Default values will be used for any argument not 
# provided when the workflow is executed.

description: Watermarks an image.

functions:
  # The fuction call to add a watermark to the base64 image
- id: apply-watermark
  type: knative-workflow
  image: direktiv/image-watermark

states:
    # Validate the input or set some default
- id: validate-input
  type: validate
  schema:
    title: Input watermark variables
    type: object
    required: ["image", "text", "color"]
    properties:
      projectid:
        title: Base64 image
        type: string
        default: "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"
      location:
        title: Text for watermark
        type: string
        default: "Watermarked by Direktiv"
      searchstring:
        title: Watermark color
        type: string
        default: "#FFFFFFC0"       
  transition: apply-watermark
- id: apply-watermark
  type: action
  action:
    function: apply-watermark
    input:
      text: 'jq(.text)'
      img: 'jq(.image)'
      color: 'jq(.color)'
